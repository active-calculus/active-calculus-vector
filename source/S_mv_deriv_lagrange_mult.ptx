<?xml version="1.0"?>
<!-- **********************************************************************-->
<!-- Copyright 2013-2018                                                   -->
<!-- Steven Schlicker                                                      -->
<!--                                                                       -->
<!-- This file is part of Active Calculus Multivariable.                   -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-NC-SA license.  The work   -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike"; no party may sell this work or any of its    -->
<!-- derivatives for profit.  All trademarks are the registered marks of   -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xml:id="S-10-8-Lagrange-Multipliers">
  <title>Constrained Optimization: Lagrange Multipliers</title>
  
    <objectives>
        <ul>
          <li>
            <p>
              What geometric condition enables us to optimize a function <m>f=f(x,y)</m> subject to a constraint given by <m>g(x,y) = k</m>, where <m>k</m> is a constant?
            </p>
          </li>

          <li>
            <p>
              How can we exploit this geometric condition to find the extreme values of a function subject to a constraint?
            </p>
          </li>
        </ul>
    </objectives>

    <introduction>
    <p>
      We previously considered how to find the extreme values of functions on both unrestricted domains and on closed, bounded domains. Other types of optimization problems involve maximizing or minimizing a quantity subject to an external constraint. In these cases the extreme values frequently won't occur at the points where the gradient is zero, but rather at other points that satisfy an important geometric condition. These problems are often called <em>constrained optimization</em> problems and can be solved with the method of Lagrange Multipliers, which we study in this section.
    </p>

    <exploration xml:id="PA_10_8">
      <statement>
        <p>
          According to U.S.<nbsp/>postal regulations, the girth plus the length of a parcel sent by mail may not exceed 108 inches, where by <q>girth</q> we mean the perimeter of the smallest end. Our goal is to find the largest possible volume of a rectangular parcel with a square end that can be sent by mail. (We solved this applied optimization problem in single variable <em>Active Calculus</em>, so it may look familiar. We take a different approach in this section, and this approach allows us to view most applied optimization problems from single variable calculus as constrained optimization problems, as well as provide us tools to solve a greater variety of optimization problems.) If we let <m>x</m> be the length of the side of one square end of the package and <m>y</m> the length of the package, then we want to maximize the volume <m>f(x,y) = x^2y</m> of the box subject to the constraint that the girth (<m>4x</m>) plus the length (<m>y</m>) is as large as possible, or <m>4x+y = 108</m>. The equation <m>4x + y = 108</m> is thus an external constraint on the variables.
        </p>
        <ol marker="a.">
        <li>
          <p>
            The constraint equation involves the function <m>g</m> that is given by
            <me>
              g(x,y) = 4x+y.
            </me>
            Explain why the constraint is a contour of <m>g</m>, and is therefore a two-dimensional curve.

            <figure xml:id="F_10_8_preview">
              <caption>Contours of <m>f</m> and the constraint equation <m>g(x,y) = 108</m>.</caption>
              <image width="50%" source="images/fig_10_8_postal"/>
            </figure>

          </p>
        </li>

        <li>
          <p>
            <xref ref="F_10_8_preview">Figure</xref> shows the graph of the constraint equation <m>g(x,y) = 108</m> along with a few contours of the volume function <m>f</m>.  Since our goal is to find the maximum value of <m>f</m> subject to the constraint <m>g(x,y) = 108</m>, we want to find the point on our constraint curve that intersects the contours of <m>f</m> at which <m>f</m> has its largest value.
          </p>
          <ol marker="i.">
            <li>
              <p>
                Points <m>A</m> and <m>B</m> in <xref ref="F_10_8_preview">Figure</xref> lie on a contour of <m>f</m> and on the constraint equation <m>g(x,y) = 108</m>. Explain why neither <m>A</m> nor <m>B</m> provides a maximum value of <m>f</m> that satisfies the constraint.
              </p>
            </li>

            <li>
              <p>
                Points <m>C</m> and <m>D</m> in <xref ref="F_10_8_preview">Figure</xref> lie on a contour of <m>f</m> and on the constraint equation <m>g(x,y) = 108</m>. Explain why neither <m>C</m> nor <m>D</m> provides a maximum value of <m>f</m> that satisfies the constraint.
              </p>
            </li>

            <li>
              <p>
                Based on your responses to parts i. and ii., draw the contour of <m>f</m> on which you believe <m>f</m> will achieve a maximum value subject to the constraint <m>g(x,y) = 108</m>. Explain why you drew the contour you did.
              </p>
            </li>
          </ol>
        </li>

        <li>
          <p>
            Recall that <m>g(x,y) = 108</m> is a contour of the function <m>g</m>, and that the gradient of a function is always orthogonal to its contours. With this in mind, how should <m>\nabla f</m> and <m>\nabla g</m> be related at the optimal point? Explain.
          </p>
        </li>
        </ol>
      </statement>

      <answer>
        <ol marker="a.">
          <li>
            <p>
              A contour is a curve obtained by setting the dependent variable equal to a constant.
              So if <m>g(x,y) = 4x+y</m>,
              then the equation <m>108 = 4x+y = g(x,y)</m> is a contour of <m>g</m>.
            </p>
          </li>
          <li>
            <p>
              Notice that there are contours of <m>f</m> that intersect the constraint with higher values of <m>f</m> than occur at points <m>A</m>,
              <m>B</m>, <m>C</m>, or <m>D</m>.
              It appears that that maximum value of <m>f</m> that we want will occur at a point where the contour of <m>f</m> intersects the constraint at only one point <mdash/> or when the contour of <m>f</m> is tangent to the constraint.
            </p>
          </li>
          <li>
            <p>
              When the graph of the constraint is tangent to a level curve of <m>f</m>,
              then the two curves will have the same direction at this point.
              This implies any two vectors that are orthogonal to these level curves will have to be parallel at the point of tangency.
              So <m>\nabla f</m> and <m>\nabla g</m> will have to be parallel at the point of tangency.
            </p>
          </li>
        </ol>
      </answer>

      <solution>
        <ol marker="a.">
          <li>
            <p>
              A contour is a curve obtained by setting the dependent variable equal to a constant.
              So if <m>g(x,y) = 4x+y</m>,
              then the equation <m>108 = 4x+y = g(x,y)</m> is a contour of <m>g</m>.
            </p>
          </li>
          <li>
            <p>
              Notice that there are contours of <m>f</m> that intersect the constraint with higher values of <m>f</m> than occur at points <m>A</m>,
              <m>B</m>, <m>C</m>, or <m>D</m>.
              It appears that that maximum value of <m>f</m> that we want will occur at a point where the contour of <m>f</m> intersects the constraint at only one point <mdash/> or when the contour of <m>f</m> is tangent to the constraint.
            </p>
          </li>
          <li>
            <p>
              When the graph of the constraint is tangent to a level curve of <m>f</m>,
              then the two curves will have the same direction at this point.
              This implies any two vectors that are orthogonal to these level curves will have to be parallel at the point of tangency.
              So <m>\nabla f</m> and <m>\nabla g</m> will have to be parallel at the point of tangency.
            </p>
          </li>
        </ol>
      </solution>

    </exploration>
  </introduction>

  <subsection>
    <title>Constrained Optimization and Lagrange Multipliers</title>
    <p>
      In <xref ref="PA_10_8">Preview Activity</xref>, we considered an optimization problem where there is an external constraint on the variables, namely that the girth plus the length of the package cannot exceed 108 inches. We saw that we can create a function <m>g</m> from the constraint, specifically <m>g(x,y) = 4x+y</m>. The constraint equation is then just a contour of <m>g</m>, <m>g(x, y) = c</m>, where <m>c</m> is a constant (in our case 108). <xref ref="F_10_8_Lagrange1">Figure</xref> illustrates that the volume function <m>f</m> is maximized, subject to the constraint <m>g(x, y) = c</m>, when the graph of <m>g(x, y) = c</m> is tangent to a contour of <m>f</m>. Moreover, the value of <m>f</m> on this contour is the sought maximum value.
    </p>

    <figure xml:id="F_10_8_Lagrange1">
      <caption>Contours of <m>f</m> and the constraint contour.</caption>
      <image width="50%" source="images/fig_10_8_postal_solution"/>
    </figure>

    <p>
      To find this point where the graph of the constraint is tangent to a contour of <m>f</m>, recall that <m>\nabla f</m> is perpendicular to the contours of <m>f</m> and <m>\nabla g</m> is perpendicular to the contour of <m>g</m>. At such a point, the vectors <m>\nabla g</m> and <m>\nabla f</m> are parallel, and thus we need to determine the points where this occurs. Recall that two vectors are parallel if one is a nonzero scalar multiple of the other, so we therefore look for values of a parameter <m>\lambda</m> that make
      <men xml:id="eq_10_8_Lagrange_ex1">
        \nabla f = \lambda \nabla g.
      </men>
    </p>

    <p>
      The constant <m>\lambda</m> is called a <em>Lagrange multiplier</em><idx><h>Lagrange multiplier</h></idx>.
    </p>

    <p>
      To find the values of <m>\lambda</m> that satisfy <xref ref="eq_10_8_Lagrange_ex1"/> for the volume function in <xref ref="PA_10_8">Preview Activity</xref>, we calculate both <m>\nabla f</m> and <m>\nabla g</m>. Observe that
      <me>
        \nabla f = 2xy \vi + x^2 \vj \ \ \ \ \text{ and }  \ \ \ \ \nabla g = 4\vi + \vj,
      </me>
      and thus we need a value of <m>\lambda</m> so that
      <me>
        2xy \vi + x^2 \vj = \lambda(4\vi + \vj).
      </me>
    </p>

    <p>
      Equating components in the most recent equation and incorporating the original constraint, we have three equations
      <mdn>
      <mrow xml:id="eq_10_8_lag_ex1">
         2xy \amp = \lambda (4) 
      </mrow>
      <mrow xml:id="eq_10_8_lag_ex2">
         x^2 \amp = \lambda (1) 
      </mrow>
      <mrow xml:id="eq_10_8_lag_ex3">
         4x+y \amp = 108 
      </mrow>
      </mdn>
      in the three unknowns <m>x</m>, <m>y</m>, and <m>\lambda</m>. First, note that if <m>\lambda = 0</m>, then equation <xref ref="eq_10_8_lag_ex2"/> shows that <m>x=0</m>. From this, Equation<nbsp/><xref ref="eq_10_8_lag_ex3"/> tells us that <m>y = 108</m>. So the point <m>(0,108)</m> is a point we need to consider. Next, provided that <m>\lambda \neq 0</m> (from which it follows that <m>x \neq 0</m> by Equation <xref ref="eq_10_8_lag_ex2"/>), we may divide both sides of Equation<nbsp/><xref ref="eq_10_8_lag_ex1"/> by the corresponding sides of <xref ref="eq_10_8_lag_ex2"/> to eliminate <m>\lambda</m>, and thus find that
      <md>
        <mrow>\frac{2y}{x} \amp = 4, \ \mbox{so}</mrow>
        <mrow>y \amp = 2x.</mrow>
      </md>
    </p>

    <p>
      Substituting into Equation<nbsp/><xref ref="eq_10_8_lag_ex3"/> gives us
      <me>
        4x+2x = 108
      </me>
      or
      <me>
        x = 18.
      </me>
    </p>

    <p>
      Thus we have <m>y = 2x = 36</m> and <m>\lambda = x^2 = 324</m> as another point to consider. So the points at which the gradients of <m>f</m> and <m>g</m> are parallel, and thus at which <m>f</m> may have a maximum or minimum subject to the constraint, are <m>(0,108)</m> and <m>(18,36)</m>. By evaluating the function <m>f</m> at these points, we see that we maximize the volume when the length of the square end of the box is 18 inches and the length is 36 inches, for a maximum volume of <m>f(18,36) = 11664</m> cubic inches. Since <m>f(0,108) = 0</m>, we obtain a minimum value at this point.
    </p>

    <p>
      We summarize the process of Lagrange multipliers as follows.
    </p>

    <assemblage xml:id="Lagrange-multipliers">
      <title>The method of Lagrange multipliers</title>
    <p>
      The general technique for optimizing a function <m>f = f(x,y)</m> subject to a constraint <m>g(x,y)=c</m> is to solve the system <m>\nabla f = \lambda \nabla g</m> and <m>g(x,y)=c</m> for <m>x</m>, <m>y</m>, and <m>\lambda</m>. We then evaluate the function <m>f</m> at each point <m>(x,y)</m> that results from a solution to the system in order to find the optimum values of <m>f</m> subject to the constraint.
    </p>
    </assemblage>

    

    <activity xml:id="A_10_8_1">
      <statement>
        <p>
          A cylindrical soda can holds about 355 cc of liquid. In this activity, we want to find the dimensions of such a can that will minimize the surface area. For the sake of simplicity, assume the can is a perfect cylinder. 
          <ol marker="a.">
            <li>
              <p>
                What are the variables in this problem? Based on the context, what restriction(s), if any, are there on these variables?
              </p>
            </li>

            <li>
              <p>
                What quantity do we want to optimize in this problem? What equation describes the constraint? (You need to decide which of these functions plays the role of <m>f</m> and which plays the role of <m>g</m> in our discussion of Lagrange multipliers.)
              </p>
            </li>

            <li>
              <p>
                Find <m>\lambda</m> and the values of your variables that satisfy Equation <xref ref="eq_10_8_Lagrange_ex1"/> in the context of this problem.
              </p>
            </li>

            <li>
              <p>
                Determine the dimensions of the pop can that give the desired solution to this constrained optimization problem.
              </p>
            </li>
          </ol>
        </p>
      </statement>

      <answer>
        <ol marker="a.">
          <li>
            <p>
              Assume the pop can is cylindrical.
              Let <m>r</m> by the radius and <m>h</m> the height of the can.
              The volume <m>V</m> of the can is constant at 355 cc of liquid.
              The radius and height can be any positive numbers as long as the volume is 355.
            </p>
          </li>
          <li>
            <p>
              We want to minimize the surface area <m>A</m> of the can, where
              <me>
                A(r,h) = 2\pi r^2 + 2\pi r h
              </me>.
              The volume of the can is <m>V(r,h) = \pi r^2 h</m>, so our constraint is
              <me>
                355 = V(r,h) = \pi r^2 h
              </me>.
            </p>
          </li>
          <li>
            <p>
              We find 
              <me>
                r \approx 3.84 \text{ cm } 
              </me>.
              This makes
              <me>
                h = \frac{355}{\pi r^2} \approx 7.66 \text{ cm }
              </me>
              and
              <me>
                \lambda = \frac{2}{r} \approx 0.52
              </me>.
            </p>
          </li>
          <li>
            <p>
              To minimize the surface area under the assumptions we have made,
              the radius should be approximately 3.84 cm and the height approximately 7.66 cm.
            </p>
          </li>
        </ol>
      </answer>


      <solution>
        <ol marker="a.">
          <li>
            <p>
              Assume the pop can is cylindrical.
              Let <m>r</m> by the radius and <m>h</m> the height of the can.
              The volume <m>V</m> of the can is constant at 355 cc of liquid.
              The radius and height can be any positive numbers as long as the volume is 355.
            </p>
          </li>
          <li>
            <p>
              We want to minimize the surface area <m>A</m> of the can, where
              <me>
                A(r,h) = 2\pi r^2 + 2\pi r h
              </me>.
              The volume of the can is <m>V(r,h) = \pi r^2 h</m>, so our constraint is
              <me>
                355 = V(r,h) = \pi r^2 h
              </me>.
            </p>
          </li>
          <li>
            <p>
              To solve this constrained optimization problem,
              we need to find the values of <m>\lambda</m>,
              <m>r</m>, and <m>h</m> that satisfy
              <md>
                <mrow>\nabla A \amp = \lambda \nabla V</mrow>
                <mrow>\left\langle 4\pi r + 2\pi h, 2 \pi r \right\rangle \amp = \lambda \left\langle 2\pi rh, \pi r^2 \right\rangle</mrow>
              </md>.
              So we have to solve the equations
              <md>
                <mrow>\pi r^2h \amp = 355</mrow>
                <mrow>4\pi r + 2\pi h \amp = \lambda 2\pi rh</mrow>
                <mrow>2 \pi r \amp = \lambda \pi r^2</mrow>
              </md>.
              Since <m>r \gt 0</m>, these equations simplify to
              <md>
                <mrow>2\pi r^2h \amp = 355</mrow>
                <mrow>2r + h \amp = \lambda rh</mrow>
                <mrow>2 \amp = \lambda r</mrow>
              </md>.
              So
              <men xml:id="eq_LM_example1">
                \lambda = \frac{2}{r} = \frac{2r+h}{rh}
              </men>.
              Now
              <me>
                h = \frac{355}{\pi r^2}
              </me>,
              so equation <xref ref="eq_LM_example1"/> becomes
              <me>
                \frac{2}{r} = \frac{r+h}{rh} = \frac{2\pi r^3+355}{355r}
              </me>.
              Applying some algebra yields
              <md>
                <mrow>\frac{2}{r} \amp = \frac{2\pi r^3+355}{355r}</mrow>
                <mrow>710 \amp = 2\pi r^3 + 355</mrow>
                <mrow>r^3 \amp = \frac{355}{2\pi}</mrow>
                <mrow>r \amp = \sqrt[3]{\frac{355}{2\pi}}</mrow>
                <mrow>r \amp \approx 3.84 \text{ cm } </mrow>
              </md>.
              This makes
              <me>
                h = \frac{355}{\pi r^2} \approx 7.66 \text{ cm }
              </me>
              and
              <me>
                \lambda = \frac{2}{r} \approx 0.52
              </me>.
            </p>
          </li>
          <li>
            <p>
              To minimize the surface area under the assumptions we have made,
              the radius should be approximately 3.84 cm and the height approximately 7.66 cm.
            </p>
          </li>
        </ol>
      </solution>


    </activity>

    <p>
      The method of Lagrange multipliers also works for functions of more than two variables.
    </p>

    <activity xml:id="A_10_8_2">
      <statement>
        <p>
          Use the method of Lagrange
          multipliers to find the dimensions of the least
          expensive packing crate with a volume of 240 cubic feet when the
          material for the top costs $2 per square foot, the bottom is $3
          per square foot and the sides are $1.50 per square foot.
        </p>
      </statement>

      <answer>
        <p>
          To minimize the cost of this crate,
          the crate should be a box of approximate dimensions <m>5.24 \times 5.24 \times 8.74</m> feet.
        </p>
      </answer>


      <solution>
        <p>
          We want to minimize the cost <m>C</m> of the crate.
          Let <m>x</m> be the length,
          <m>y</m> the width, and <m>z</m> the height of the crate.
          The volume <m>V = xyz</m> of the crate is to be 240 cubic feet,
          so <m>x \gt 0</m>, <m>y \gt 0</m>, and <m>z \gt 0</m>.
          The area of the top and bottom of the crate is <m>2xy</m>,
          so the cost of the top of the crate is <m>2xy</m> and the cost of the bottom is <m>3xy</m>.
          The area of the sides of the crate is
          <m>2xz + 2yz</m> and so the cost of the sides is <m>1.5(2xz+2yz)</m>.
          Thus, the total cost of the crate is
          <me>
            C(x,y,z) = 5xy + 3(xz+yz)
          </me>.
        </p>
        <p>
          The volume of the crate is to be 240 cubic feet, so our constraint is
          <me>
            240 = V(x,y,z) = xyz
          </me>.
        </p>
        <p>
          Now
          <me>
            \nabla C = \lambda \nabla V
          </me>
          implies
          <me>
            \nabla C = \langle 5y+3z, 5x+3z, 3(x+y) \rangle = \lambda \langle yz, xz, xy \rangle
          </me>.
        </p>
        <p>
          So we need to solve the system of equations
          <md>
            <mrow>xyz \amp = 240</mrow>
            <mrow>5y+3z \amp = \lambda(yz)</mrow>
            <mrow>5x+3z \amp = \lambda(xz)</mrow>
            <mrow>3(x+y) \amp = \lambda(xy)</mrow>
          </md>.
        </p>
        <p>
          The last three equations give us
          <me>
            \lambda = \frac{5}{z} + \frac{3}{y} = \frac{5}{z}+\frac{3}{x} = \frac{3}{x}+\frac{3}{y}
          </me>.
        </p>
        <p>
          Using the fact that <m>z = \frac{240}{xy}</m> we have
          <me>
            \frac{xy}{48}+\frac{3}{y} = \frac{xy}{248}+\frac{3}{x} = \frac{3}{y}+\frac{3}{x}
          </me>.
        </p>
        <p>
          Using the equation
          <me>
            \frac{xy}{48}+\frac{3}{y} =  \frac{3}{y}+\frac{3}{x}
          </me>
          gives us
          <me>
            y = \frac{144}{x^2}
          </me>.
        </p>
        <p>
          Then we substitute into the equation
          <md>
            <mrow>\frac{xy}{48}+\frac{3}{x} \amp = \frac{3}{y}+\frac{3}{x}</mrow>
            <mrow>\frac{xy}{48} \amp = \frac{3}{y}</mrow>
            <mrow>\frac{3}{x} \amp = \frac{x^2}{48}</mrow>
            <mrow>x^3 \amp = 144</mrow>
            <mrow>x \amp = \sqrt[3]{144}</mrow>
            <mrow>x \amp \approx 5.24 \text{ ft } </mrow>
          </md>.
        </p>
        <p>
          Then
          <me>
            y = \frac{144}{x^2} = \sqrt[3]{144} \approx 5.24 \text{ ft }
          </me>
          and
          <me>
            z = \frac{240}{xy} = \approx 8.74 \text{ ft }
          </me>.
        </p>
        <p>
          Also,
          <me>
            \lambda = \frac{3}{x}+\frac{3}{y} \approx 1.15
          </me>.
        </p>
        <p>
          So to minimize the cost of this crate,
          the crate should be a box of approximate dimensions <m>5.24 \times 5.24 \times 8.74</m> feet.
        </p>
      </solution>

    </activity>

    <p> 
      The method of Lagrange multipliers also works for functions of three variables. That is, if we have a function <m>f = f(x,y,z)</m> that we want to optimize subject to a constraint <m>g(x,y,z) = k</m>, the optimal point <m>(x,y,z)</m> lies on the level surface <m>S</m> defined by the constraint <m>g(x,y,z) = k</m>. As we did in <xref ref="PA_10_8">Preview Activity</xref>, we can argue that the optimal value occurs at the level surface <m>f(x,y,z) = c</m> that is tangent to <m>S</m>. Thus, the gradients of <m>f</m> and <m>g</m> are parallel at this optimal point. So, just as in the two variable case, we can optimize <m>f = f(x,y,z)</m> subject to the constraint <m>g(x,y,z) = k</m> by finding all points <m>(x,y,z)</m> that satisfy <m>\nabla f = \lambda \nabla g</m> and <m>g(x,y,z) = k</m>. 
    </p>

  </subsection>


  <subsection>
    <title>Summary</title>
    <ul>
      <li>
        <p>
          The extrema of a function <m>f=f(x,y)</m> subject to a constraint
            <m>g(x,y) = c</m> occur at points for which the contour of <m>f</m> is tangent to the curve that represents the constraint equation. This occurs when
          <me>
            \nabla f = \lambda \nabla g.
          </me>
        </p>
      </li>

      <li>
        <p>
          We use the condition  <m>\nabla f = \lambda \nabla g</m> to generate a system of equations, together
            with the constraint <m>g(x,y) = c</m>, that may be
            solved for <m>x</m>, <m>y</m>, and <m>\lambda</m>.  Once we have all the solutions, we evaluate <m>f</m>
            at each of the <m>(x,y)</m> points to determine the extrema.
        </p>
      </li>
    </ul>

    </subsection>


    <exercises>

      <exercise label="Library__Michigan__Chap15Sec3__Q05.pg" xml:id="ex-10-8-WW-plane">
      <!--<title>Maximum and minimum values on a plane</title>-->
         <webwork source="Library/Michigan/Chap15Sec3/Q05.pg"/>
      </exercise>

      <exercise label="Library__Michigan__Chap15Sec3__Q17.pg" xml:id="ex-10-8-WW-cubic">
      <!--<title>Maximum and minimum values of a cubic</title>-->
         <webwork source="Library/Michigan/Chap15Sec3/Q17.pg"/>
      </exercise>

      <exercise label="Library__Dartmouth__setStewartCh15S8__problem_2.pg" xml:id="ex-10-8-WW-square-sum">
      <!--<title>Maximum and minimum values of a sum of squares</title>-->
         <webwork source="Library/Dartmouth/setStewartCh15S8/problem_2.pg"/>
      </exercise>

      <exercise label="Library__Dartmouth__setStewartCh15S8__problem_1.pg" xml:id="ex-10-8-WW-hyperbola">
      <!--<title>Maximum and minimum values on a hyperbola</title>-->
         <webwork source="Library/Dartmouth/setStewartCh15S8/problem_1.pg"/>
      </exercise>

      <exercise label="Library__Michigan__Chap15Sec3__Q40.pg" xml:id="ex-10-8-WW-distance">
      <!--<title>Minimizing a distance</title>-->
         <webwork source="Library/Michigan/Chap15Sec3/Q40.pg"/>
      </exercise>

      <exercise label="Library__Michigan__Chap15Sec3__Q43.pg" xml:id="ex-10-8-WW-two-ways">
      <!--<title>Constrained optimization two ways</title>-->
         <webwork source="Library/Michigan/Chap15Sec3/Q43.pg"/>
      </exercise>

      <exercise label="Library__272__setStewart14_8__problem_10.pg" xml:id="ex-10-8-WW-plane-ellipse">
      <!--<title>Intersection of a plane and an ellipse</title>-->
         <webwork source="Library/272/setStewart14_8/problem_10.pg"/>
      </exercise>

      <exercise label="Library__Dartmouth__setStewartCh15S8__problem_3.pg" xml:id="ex-10-8-WW-3-variable">
      <!--<title>Optimizing a function of three variables</title>-->
         <webwork source="Library/Dartmouth/setStewartCh15S8/problem_3.pg"/>
      </exercise>

      <exercise label="Library__Dartmouth__setStewartCh15S8__problem_4.pg" xml:id="ex-10-8-WW-4-variable">
      <!--<title>Optimizing a function of four variables</title>-->
         <webwork source="Library/Dartmouth/setStewartCh15S8/problem_4.pg"/>
      </exercise>

      <exercise label="Library__Dartmouth__setStewartCh15S8__problem_9.pg" xml:id="ex-10-8-WW-volume">
      <!--<title>Maximum and minimum volumes of a box</title>-->
         <webwork source="Library/Dartmouth/setStewartCh15S8/problem_9.pg"/>
      </exercise>

      <exercise label="Library__Michigan__Chap15Sec3__Q38.pg" xml:id="ex-10-8-WW-squares">
      <!--<title>Maximizing a sum of squares</title>-->
         <webwork source="Library/Michigan/Chap15Sec3/Q38.pg"/>
      </exercise>

      <!--MBX exception
      <exercise xml:id="ex-10-8-WW-indifference">
      <title>Indifference curves</title>
         <webwork source="Library/Michigan/Chap15Sec3/Q23.pg" />
      </exercise> -->

      <exercise>
        <statement>
          <p>
            The Cobb-Douglas production function<idx><h>Cobb-Douglas production function</h></idx> is used in economics to model production levels based on labor and equipment. Suppose we have a specific Cobb-Douglas function of the form
            <me>
              f(x, y) = 50 x^{0.4}y^{0.6},
            </me>
            where <m>x</m> is the dollar amount spent on labor and <m>y</m> the dollar amount spent on equipment. Use the method of Lagrange multipliers to determine how much should be spent on labor and how much on equipment to maximize productivity if we have a total of 1.5 million dollars to invest in labor and equipment.
          </p>
        </statement>

        <answer>
          <p>
            We maximize our output when we spend $0.6 million on labor and $0.9 million on equipment.
          </p>
        </answer>


        <solution>
          <p>
            To find the values of <m>\lambda</m> that satisfy
            <m>\nabla f = \lambda \nabla g</m> for our Cobb-Douglas function,
            we calculate both <m>\nabla f</m> and <m>\nabla g</m>.
            Now
            <me>
              \nabla f = \frac{20y^{0.6}}{x^{0.6}} \vi + \frac{30x^{0.4}}{y^{0.4}} \vj \ \ \ \ \text{ and }  \ \ \ \ \nabla g = \vi + \vj
            </me>,
            so we need a value of <m>\lambda</m> so that
            <me>
              \frac{20y^{0.6}}{x^{0.6}} \vi + \frac{30x^{0.4}}{y^{0.4}} \vj = \lambda(\vi + \vj)
            </me>.
          </p>
          <p>
            Equating components and the original constraint give us the three equations
            <md>
              <mrow xml:id="eqn_10_8_lag_ex1" number="yes">20y^{0.6} \amp = \lambda x^{0.6}</mrow>
              <mrow xml:id="eqn_10_8_lag_ex2" number="yes">30x^{0.4} \amp = \lambda y^{0.4}</mrow>
              <mrow xml:id="eqn_10_8_lag_ex3" number="yes">x+y \amp = 1.5</mrow>
            </md>
            in the three unknowns <m>x</m>,
            <m>y</m>, and <m>\lambda</m>.
            Dividing both sides of <xref ref="eqn_10_8_lag_ex1"/> by the corresponding sides of <xref ref="eqn_10_8_lag_ex2"/> yields
            <md>
              <mrow>\frac{2}{3} \frac{y^{0.6}}{x^{0.4}} \amp = \frac{x^{0.6}}{y^{0.4}}</mrow>
              <mrow xml:id="eq_10_8_lag_ex4" number="yes">\frac{2}{3} y \amp = x</mrow>
            </md>
          </p>
          <p>
            Substituting into <xref ref="eqn_10_8_lag_ex3"/> gives us
            <me>
              \frac{2}{3}y + y = 1.5
            </me>
            or
            <me>
              y = \frac{9}{10}
            </me>.
          </p>
          <p>
            Then <m>x = \frac{3}{5}</m> and <m>\lambda \approx 25.51</m>.
            Therefore we maximize our output when we spend $0.6 million on labor and $0.9 million on equipment.
          </p>
        </solution>

        
      </exercise>


      <exercise>
        <statement>
          <p>
            Use the method of Lagrange multipliers to find the point on the line
            <m>x-2y=5</m> that is closest to the point <m>(1,3)</m>. To do so, respond to the following prompts.
            <ol marker="a.">
              <li>
                <p>
                  Write the function <m>f=f(x,y)</m> that measures the <em>square</em> of
                      the distance from <m>(x,y)</m> to <m>(1,3)</m>.  (The extrema of this
                      function are the same as the extrema of the distance function, but
                      <m>f(x,y)</m> is simpler to work with.)
                </p>
              </li>

              <li>
                <p>
                  What is the constraint <m>g(x,y) = c</m>?
                </p>
              </li>

              <li>
                <p>
                  Write the equations resulting from <m>\nabla f = \lambda \nabla
                      g</m> and the constraint.  Find all the points
                      <m>(x,y)</m> satisfying these equations.
                </p>
              </li>

              <li>
                <p>
                  Test all the points you found to determine the extrema.
                </p>
              </li>
            </ol>
          </p>
        </statement>

        <answer>
          <ol marker="a.">
            <li>
              <p>
                The square of the distance from <m>(x,y)</m> to <m>(1,3)</m> is given by <m>f(x,y) = (x-1)^2 + (y-3)^2</m>.
              </p>
            </li>
            <li>
              <p>
                The constraint is that the point <m>(x,y)</m> lies on the line <m>x-2y=5</m>,
                so <m>g(x,y) = x-2y</m>.
              </p>
            </li>
            <li>
              <p>
                Since <m>\nabla f = \langle 2(x-1) + 2(y-3)</m> and <m>\nabla g = \langle 1, -2 \rangle</m>,
                the equations resulting from
                <m>\nabla f = \lambda \nabla g</m> and the constraint are
                <md>
                  <mrow>2(x-1) \amp = \lambda</mrow>
                  <mrow>2(y-3) \amp = -2\lambda</mrow>
                  <mrow>x-2y \amp = 5</mrow>
                </md>.
                Substituting <m>2(x-1)</m> for <m>\lambda</m> in the second equation yields <m>2(y-3) = -4(x-1)</m> or <m>4x+2y=10</m>.
                Adding corresponding sides of this new equation with the third equation gives us <m>5x = 15</m> or <m>x=3</m>.
                Then <m>y = -1</m>.
              </p>
            </li>
            <li>
              <p>
                This single critical point gives us an extreme distance of <m>\sqrt{f(3,-1)} = \sqrt{20}</m>.
                This is the only extreme value and since points on the plane can be found as far as possible from the point <m>(1,3)</m>,
                we have found the minimum distance.
              </p>
            </li>
          </ol>
        </answer>


        <solution>
          <ol marker="a.">
            <li>
              <p>
                The square of the distance from <m>(x,y)</m> to <m>(1,3)</m> is given by <m>f(x,y) = (x-1)^2 + (y-3)^2</m>.
              </p>
            </li>
            <li>
              <p>
                The constraint is that the point <m>(x,y)</m> lies on the line <m>x-2y=5</m>,
                so <m>g(x,y) = x-2y</m>.
              </p>
            </li>
            <li>
              <p>
                Since <m>\nabla f = \langle 2(x-1) + 2(y-3)</m> and <m>\nabla g = \langle 1, -2 \rangle</m>,
                the equations resulting from
                <m>\nabla f = \lambda \nabla g</m> and the constraint are
                <md>
                  <mrow>2(x-1) \amp = \lambda</mrow>
                  <mrow>2(y-3) \amp = -2\lambda</mrow>
                  <mrow>x-2y \amp = 5</mrow>
                </md>.
                Substituting <m>2(x-1)</m> for <m>\lambda</m> in the second equation yields <m>2(y-3) = -4(x-1)</m> or <m>4x+2y=10</m>.
                Adding corresponding sides of this new equation with the third equation gives us <m>5x = 15</m> or <m>x=3</m>.
                Then <m>y = -1</m>.
              </p>
            </li>
            <li>
              <p>
                This single critical point gives us an extreme distance of <m>\sqrt{f(3,-1)} = \sqrt{20}</m>.
                This is the only extreme value and since points on the plane can be found as far as possible from the point <m>(1,3)</m>,
                we have found the minimum distance.
              </p>
            </li>
          </ol>
        </solution>
        
      </exercise>

      <exercise>
        <statement>
          <p>
            Apply the Method of Lagrange Multipliers to solve each of the following constrained optimization problems.
            <ol marker="a.">
              <li>
                <p>
                  Determine the absolute maximum and absolute minimum values of <m>f(x,y) = (x-1)^2 + (y-2)^2</m> subject to the constraint that <m>x^2 + y^2 = 16</m>.
                </p>
              </li>

              <li>
                <p>
                  Determine the points on the sphere <m>x^2 + y^2 + z^2 = 4</m> that are closest to and farthest from the point <m>(3,1,-1)</m>.  (As in the preceding exercise, you may find it simpler to work with the square of the distance formula, rather than the distance formula itself.)
                </p>
              </li>

              <li>
                <p>
                  Find the absolute maximum and minimum of <m>f(x,y,z) = x^2 + y^2 + z^2</m> subject to the constraint that <m>(x-3)^2 + (y+2)^2 + (z-5)^2 \le 16</m>.  (Hint: here the constraint is a closed, bounded region.  Use the boundary of that region for applying Lagrange Multipliers, but don't forget to also test any critical values of the function that lie in the interior of the region.)
                </p>
              </li>
            </ol>
          </p>
        </statement>

        <answer>
          <ol marker="a.">
            <li>
              <p>
                The maximum value of <m>f</m> subject to this constraint is
                <m>21+8\sqrt{5}</m> and occurs at the point
                <m>\left(\frac{4}{\sqrt{5}}, \frac{8}{\sqrt{5}}\right)</m> while the minimum value is
                <m>21-8\sqrt{5}</m> and occurs at <m>\left(-\frac{4}{\sqrt{5}}, -\frac{8}{\sqrt{5}}\right)</m>.
              </p>
            </li>
            <li>
              <p>
                The point on the sphere closest to <m>(3,1,-1)</m> is
                <m>\left(\frac{6}{\sqrt{11}}, \frac{2}{\sqrt{11}}, -\frac{2}{\sqrt{11}} \right)</m> and the point on the sphere farthest from
                <m>(3,1,-1)</m> is <m>\left(-\frac{6}{\sqrt{11}}, -\frac{2}{\sqrt{11}}, \frac{2}{\sqrt{11}} \right)</m>.
              </p>
            </li>
            <li>
              <p>
                The absolute maximum value of <m>f</m> on the domain <m>(x-3)^2 + (y+2)^2 + (z-5)^2 \le 16</m> is
                <m>54+8\sqrt{38}</m> and the absolute minimum value is 0.
              </p>
            </li>
          </ol>
        </answer>

        <solution>
          <ol marker="a.">
            <li>
              <p>
                Here we have <m>g(x,y) = x^2+y^2</m>,
                so the system of equations resulting from
                <m>\nabla f = \lambda \nabla g</m> and the constraint is
                <md>
                  <mrow>2(x-1) \amp = 2\lambda x</mrow>
                  <mrow>2(y-2) \amp = 2\lambda y</mrow>
                  <mrow>x^2 + y^2 \amp = 16</mrow>
                </md>.
                Dividing corresponding sides of the first equation by the second shows that
                <m>\frac{x-1}{y-2} = \frac{x}{y}</m> or <m>(x-1)y = x(y-2)</m>.
                Simplifying yields <m>y=2x</m>.
                Substituting into the constraint equation gives us
                <m>x^2+4x^2 = 16</m> or <m>x = \pm \frac{4}{\sqrt{5}}</m>.
                Checking the values of <m>f</m> at these critical points we see that
                <md>
                  <mrow>f\left(\frac{4}{\sqrt{5}}, \frac{8}{\sqrt{5}}\right) \amp = 21-8\sqrt{5} \approx 3.11</mrow>
                  <mrow>f\left(-\frac{4}{\sqrt{5}}, -\frac{8}{\sqrt{5}}\right) \amp = 21+8\sqrt{5} \approx 38.89</mrow>
                </md>.
                So the maximum value of <m>f</m> subject to this constraint is
                <m>21+8\sqrt{5}</m> and occurs at the point
                <m>\left(\frac{4}{\sqrt{5}}, \frac{8}{\sqrt{5}}\right)</m> while the minimum value is
                <m>21-8\sqrt{5}</m> and occurs at <m>\left(-\frac{4}{\sqrt{5}}, -\frac{8}{\sqrt{5}}\right)</m>.
              </p>
            </li>
            <li>
              <p>
                The square of the distance from <m>(x,y,z)</m> to
                <m>(3,1,-1)</m> is given by <m>f(x,y) = (x-3)^2 + (y-1)^2 + (z+1)^2</m>.
                The constraint is <m>g(x,y) = x^2+y^2+z^2=4</m>.
                The equations resulting from
                <m>\nabla f = \lambda \nabla g</m> and the constraint are
                <md>
                  <mrow>2(x-3) \amp = 2\lambda x</mrow>
                  <mrow>2(y-1) \amp = 2\lambda y</mrow>
                  <mrow>2(z+1) \amp = 2\lambda z</mrow>
                  <mrow>x^2+y^2+z^2 \amp = 4</mrow>
                </md>.
                Dividing corresponding sides of the first equation by the second shows that
                <m>\frac{x-3}{y-1} = \frac{x}{y}</m> or <m>(x-3)y = x(y-1)</m>.
                Simplifying yields <m>x=3y</m>.
                Dividing corresponding sides of the second equation by the third shows that
                <m>\frac{y-1}{z+1} = \frac{y}{z}</m> or <m>(y-1)z = y(z+1)</m>.
                Simplifying yields <m>z=-y</m>.
                Substituting into the constraint equation gives us <m>11y^2=4</m> or <m>y = \pm \frac{2}{\sqrt{11}}</m>.
                Checking the values of <m>f</m> at these critical points we see that
                <md>
                  <mrow>f\left(\frac{6}{\sqrt{11}}, \frac{2}{\sqrt{11}}, -\frac{2}{\sqrt{11}} \right) \amp = 15-4\sqrt{11} \approx 1.73</mrow>
                  <mrow>f\left(-\frac{6}{\sqrt{11}}, -\frac{2}{\sqrt{11}}, \frac{2}{\sqrt{11}} \right) \amp = 15+4\sqrt{11} \approx 28.27</mrow>
                </md>.
                So the point on the sphere closest to <m>(3,1,-1)</m> is
                <m>\left(\frac{6}{\sqrt{11}}, \frac{2}{\sqrt{11}}, -\frac{2}{\sqrt{11}} \right)</m> and the point on the sphere farthest from
                <m>(3,1,-1)</m> is <m>\left(-\frac{6}{\sqrt{11}}, -\frac{2}{\sqrt{11}}, \frac{2}{\sqrt{11}} \right)</m>.
              </p>
            </li>
            <li>
              <p>
                First we find the critical points of <m>f</m> inside the sphere.
                We have <m>\nabla f = 0</m> when
                <me>
                  2x = 0, \ 2y = 0, \ \text{ and }  \ 2z = 0
                </me>,
                yielding the single critical point <m>(0,0,0)</m>.
                Next we determine the critical points of <m>f</m> on the boundary of the sphere <m>(x-3)^2 + (y+2)^2 + (z-5)^2 \le 16</m>,
                using the constraint <m>g(x,y,z) = (x-3)^2 + (y+2)^2 + (z-5)^2 = 16</m>.
                The equations resulting from
                <m>\nabla f = \lambda \nabla g</m> and the constraint are
                <md>
                  <mrow>2x \amp = 2\lambda (x-3)</mrow>
                  <mrow>2y \amp = 2\lambda (y+2)</mrow>
                  <mrow>2z \amp = 2\lambda (z-5)</mrow>
                  <mrow>(x-3)^2 + (y+2)^2 + (z-5)^2 \amp = 16</mrow>
                </md>.
                Dividing corresponding sides of the first equation by the second shows that
                <m>\frac{x}{y} = \frac{x-3}{y+2}</m> or <m>x(y+2)=y(x-3)</m>.
                Simplifying yields <m>x=-\frac{3}{2}y</m>.
                Dividing corresponding sides of the second equation by the third shows that
                <m>\frac{y}{z}=\frac{y+2}{z-5}</m> or <m>y(z-5) = z(y+2)</m>.
                Simplifying yields <m>z=-\frac{5}{2}y</m>.
                Substituting into the constraint equation gives us <m>\frac{19}{2}y^2+38y+38=16</m>.
                The quadratic formula reveals that <m>y = -2 \pm \frac{4}{19} \sqrt{38}</m>.
                Checking the values of <m>f</m> at these critical points we see that
                <md>
                  <mrow>f\left(-\frac{3}{2}\left(-2 +\frac{4}{19} \sqrt{38}\right), -2 + \frac{4}{19} \sqrt{38}, -\frac{5}{2}\left(-2 +\frac{4}{19} \sqrt{38}\right) \right) \amp = 54-8\sqrt{38} \approx 4.68</mrow>
                  <mrow>f\left(-\frac{3}{2}\left(-2 -\frac{4}{19} \sqrt{38}\right), -2 - \frac{4}{19} \sqrt{38}, -\frac{5}{2}\left(-2 -\frac{4}{19} \sqrt{38}\right)  \right) \amp = 54+8\sqrt{38} \approx 103.32</mrow>
                  <mrow>f(0,0,0) \amp = 0</mrow>
                </md>.
                So the absolute maximum value of <m>f</m> on the domain <m>(x-3)^2 + (y+2)^2 + (z-5)^2 \le 16</m> is
                <m>54+8\sqrt{38}</m> and the absolute minimum value is 0.
              </p>
            </li>
          </ol>
        </solution>
        
      </exercise>

      <exercise>
        <statement>
          <p>
            In this exercise we consider how to apply the Method of Lagrange Multipliers to optimize functions of three variable subject to two constraints. Suppose we want to optimize <m>f = f(x,y,z)</m> subject to the constraints <m>g(x,y,z) = c</m> and <m>h(x,y,z) = k</m>. Also suppose that the two level surfaces <m>g(x,y,z) = c</m> and <m>h(x,y,z) = k</m> intersect at a curve <m>C</m>. The optimum point <m>P = (x_0,y_0,z_0)</m> will then lie on <m>C</m>.  
            <ol marker="a.">
              <li>
                <p>
                  Assume that <m>C</m> can be represented parametrically by a vector-valued function <m>\vr = \vr(t)</m>. Let <m>\overrightarrow{OP} = \vr(t_0)</m>. Use the Chain Rule applied to <m>f(\vr(t))</m>, <m>g(\vr(t))</m>, and <m>h(\vr(t))</m>, to explain why 
                  <md> 
                    <mrow> \nabla f(x_0,y_0,z_0) \cdot \vr'(t_0) \amp =  0, </mrow>
                    <mrow> \nabla g(x_0,y_0,z_0) \cdot \vr'(t_0) \amp = 0, \text{ and } </mrow>
                    <mrow> \nabla h(x_0,y_0,z_0) \cdot \vr'(t_0) \amp = 0. </mrow>
                  </md>
                  Explain how this shows that <m>\nabla f(x_0,y_0,z_0)</m>, <m>\nabla g(x_0,y_0,z_0)</m>, and <m>\nabla h(x_0,y_0,z_0)</m> are all orthogonal to <m>C</m> at <m>P</m>. This shows that <m>\nabla f(x_0,y_0,z_0)</m>, <m>\nabla g(x_0,y_0,z_0)</m>, and <m>\nabla h(x_0,y_0,z_0)</m> all lie in the same plane.
                </p>
              </li>

              <li>
                <p>
                  Assuming that <m>\nabla g(x_0,y_0,z_0)</m> and <m>\nabla h(x_0,y_0,z_0)</m> are nonzero and not parallel, explain why every point in the plane determined by <m>\nabla g(x_0,y_0,z_0)</m> and <m>\nabla h(x_0,y_0,z_0)</m> has the form <m>s\nabla g(x_0,y_0,z_0)+t\nabla h(x_0,y_0,z_0)</m> for some scalars <m>s</m> and <m>t</m>.  
                </p>
              </li>

              <li>
                <p>
                  Parts (a.) and (b.) show that there must exist scalars <m>\lambda</m> and <m>\mu</m> such that 
                  <me> \nabla f(x_0,y_0,z_0) = \lambda \nabla g(x_0,y_0,z_0)+ \mu \nabla h(x_0,y_0,z_0).
                  </me>
                  So to optimize <m>f = f(x,y,z)</m> subject to the constraints <m>g(x,y,z) = c</m> and <m>h(x,y,z) = k</m> we must solve the system of equations
                  <md>
                    <mrow> \nabla f(x,y,z) \amp = \lambda \nabla g(x,y,z)+ \mu \nabla h(x,y,z), </mrow>
                    <mrow>g(x,y,z) \amp = c, \text{ and } </mrow>
                    <mrow> h(x,y,z) \amp = k. </mrow>
                  </md>
                  for <m>x</m>, <m>y</m>, <m>z</m>, <m>\lambda</m>, and <m>\mu</m>. 
                </p>
                <p>
                  Use this idea to find the maximum and minimum values of <m>f(x,y,z) = x+2y</m> subject to the constraints <m>y^2+z^2=8</m> and <m>x+y+z = 10</m>.
                </p>
              </li>
            </ol>
          </p>
        </statement>

        <answer>
          <ol marker="a.">
            <li>
              <p>
                Let <m>C</m> be given by the vector function <m>\vr (t) = \langle x(t), y(t), z(t) \rangle</m>, and set <m>\vr (t_0) = \langle x_0, y_0, z_0 \rangle</m>. Now let <m>F(t) = f(x(t), y(t), z(t))</m>. Since <m>P = (x_0, y_0, z_0)</m> is an extremum of <m>f</m> on the curve <m>C</m>, we must have <m>\frac{dF}{dt} = 0</m> at <m>t = t_0</m>. By Chain Rule  
                <md>
                  <mrow> \frac{dF}{dt} \amp = \frac{\partial f}{\partial x} \cdot \frac{dx}{dt} + \frac{\partial f}{\partial y} \cdot \frac{dy}{dt} + \frac{\partial f}{\partial z} \cdot \frac{dz}{dt}</mrow>
                  <mrow> \amp = \left \langle \frac{\partial f}{\partial x}, \frac{\partial f}{\partial y} , \frac{\partial f}{\partial z} \right \rangle \cdot \left \langle \frac{dx}{dt}, \frac{dy}{dt}, \frac{dz}{dt} \right \rangle </mrow>
                  <mrow> \amp = \nabla f \cdot \vr ' (t)</mrow>
                </md>.
                Thus 
                <me>
                  0 = F'(t_0) = \nabla f (x_0, y_0, z_0) \cdot \vr ' (t_0)
                </me>.
              </p>
              <p>
                Note that along the curve <m>C</m>, <m>g(x, y, z) = c</m> and <m>h(x, y, z) = k</m>, so both functions are constant. Thus their rate of change must be <m>0</m> and so we have  
                <md>
                  <mrow> \frac{d}{dt} g( \vr (t)) \amp = 0 \text{ and} </mrow>
                  <mrow> \frac{d}{dt} h( \vr (t)) \amp = 0 </mrow>
                </md>.
                Again by Chain Rule  
                <md>
                  <mrow> \frac{dg}{dt} \amp = \frac{\partial g}{\partial x} \cdot \frac{dx}{dt} + \frac{\partial g}{\partial y} \cdot \frac{dy}{dt} + \frac{\partial g}{\partial z} \cdot \frac{dz}{dt}</mrow>
                  <mrow> \amp = \left \langle \frac{\partial g}{\partial x}, \frac{\partial g}{\partial y} , \frac{\partial g}{\partial z} \right \rangle \cdot \left \langle \frac{dx}{dt}, \frac{dy}{dt}, \frac{dz}{dt} \right \rangle </mrow>
                  <mrow> \amp = \nabla g \cdot \vr ' (t)</mrow>
                </md>  
                and so  
                <me>
                  0 = g'(\vr(t_0)) = \nabla g (x_0, y_0, z_0) \cdot \vr ' (t_0)
                </me>.
                Similarly 
                <me>
                  0 = h'(\vr(t_0)) = \nabla h (x_0, y_0, z_0) \cdot \vr ' (t_0)
                </me>.
              </p>
              <p>
                Note that <m>\vr ' (t_0)</m> is the tangent vector to <m>f(t)</m> at <m>t = t_0</m>. Thus the above results show that <m>\nabla f(x_0, y_0, z_0), \nabla g(x_0, y_0, z_0)</m>, and <m>\nabla h(x_0, y_0, z_0)</m> are all orthogonal to the tangent vector of <m>C</m> since the dot product of each of these with the tangent vector <m>\vr ' (t_0)</m> is <m>0</m>. Thus all three of these gradient vectors are orthogonal to <m>C</m> at <m>P</m> and therefore they all lie in the same plane.
              </p>
            </li>
            <li>
              <p>
                We are considering the plane that contains the point <m>P = (x_0, y_0, z_0)</m> as well as the non-parallel vectors <m>\nabla g(x_0, y_0, z_0)</m> and <m>\nabla h(x_0, y_0, z_0)</m>. Note that we could compute the cross product of these vectors to find a normal vector of the plane, then use that to write an equation of the plane. Here we claim (informally) that any point in the plane can be obtained by starting at <m>P</m>, moving some distance in the direction of <m>\nabla g(x_0, y_0, z_0)</m> and then moving some distance in the direction of  <m>\nabla h(x_0, y_0, z_0)</m>. In other words, an arbitrary point in the plane can be expressed as <m>s \nabla g(x_0, y_0, z_0) + t \nabla h(x_0, y_0, z_0)</m>. (Using ideas from linear algebra, we claim that the plane determined by <m>\nabla g(x_0, y_0, z_0)</m> and <m>\nabla h(x_0, y_0, z_0)</m> is the span of these two vectors, and thus every point in the plane can be expressed as a linear combination of these two vectors.)
              </p>
            </li>
            <li>
              <p>
                For this exercise we have <m>f(x, y, z) = x + 2y, g(x, y, z) = y^2 + z^2</m>, and <m>h(x, y, z) = x + y + z</m>. Thus <m>\nabla f(x, y, z) = \langle 1, 2, 0 \rangle,\nabla g(x, y, z) = \langle 0, 2y, 2z \rangle </m>, and <m>\nabla h(x, y, z) = \langle 1, 1, 1 \rangle</m>. Therefore the system of equations we have to solve is  
                <md>
                  <mrow> \langle 1, 2, 0 \rangle \amp = \lambda \langle 0, 2y, 2z \rangle + \mu \langle 1, 1, 1 \rangle </mrow>
                  <mrow>y^2 + z^2 \amp = 8 </mrow>
                  <mrow>x + y + z \amp = 10 </mrow>
                </md>
                or  
                <md>
                  <mrow>1 \amp = \lambda (0) + \mu(1) </mrow>
                  <mrow>2 \amp = \lambda (2y) + \mu(1) </mrow>
                  <mrow>0 \amp = \lambda (2z) + \mu(1) </mrow>
                  <mrow>y^2 + z^2 \amp = 8 </mrow>
                  <mrow>x + y + z \amp = 10 </mrow>
                </md>.
                From the first equation we get <m>\mu = 1</m>. Plugging that into the second and third equations above yields <m>y = \frac{1}{2 \lambda}</m> and <m>z = - \frac{1}{2 \lambda} </m>, with <m>\lambda \neq 0 </m>. Substituting these values into the fourth equation above gives us  
                <me>
                  8 = \left ( \frac{1}{2 \lambda} \right )^2 + \left (- \frac{1}{2 \lambda} \right )^2
                </me>.
                Simplifying yields  
                <me>
                  16 \lambda ^2 = 1
                </me>, 
                and so we find <m>\lambda = \pm \frac{1}{4}</m>. If <m>\lambda = \frac{1}{4}</m>, we have <m>y = 2</m> and <m>z = -2</m>. Substituting these values into the fifth equation above yields <m>x = 10</m>. Following the same approach for <m>\lambda = - \frac{1}{4}</m> yields <m>y = -2, z = 2</m>, and <m>x = 10</m>.   
              </p>
              <p>
                Finally, we use these values to find the maximum and minimum of <m>f</m> subject to the constraints. Since <m>f(x, y, z) = x + 2y</m>, we have <m>f(10, 2, -2) = 10 + 2(2) = 14</m> and <m>f(10, -2, 2) = 10 + 2(-2) = 6</m>. So, subject to the given constraints, the maximum of <m>f</m> is 14 and the minimum of <m>f</m> is 6.
              </p>
            </li>
          </ol>  
        </answer>

        <solution>
          <ol marker="a.">
            <li>
              <p>
                Let <m>C</m> be given by the vector function <m>\vr (t) = \langle x(t), y(t), z(t) \rangle</m>, and set <m>\vr (t_0) = \langle x_0, y_0, z_0 \rangle</m>. Now let <m>F(t) = f(x(t), y(t), z(t))</m>. Since <m>P = (x_0, y_0, z_0)</m> is an extremum of <m>f</m> on the curve <m>C</m>, we must have <m>\frac{dF}{dt} = 0</m> at <m>t = t_0</m>. By Chain Rule  
                <md>
                  <mrow> \frac{dF}{dt} \amp = \frac{\partial f}{\partial x} \cdot \frac{dx}{dt} + \frac{\partial f}{\partial y} \cdot \frac{dy}{dt} + \frac{\partial f}{\partial z} \cdot \frac{dz}{dt}</mrow>
                  <mrow> \amp = \left \langle \frac{\partial f}{\partial x}, \frac{\partial f}{\partial y} , \frac{\partial f}{\partial z} \right \rangle \cdot \left \langle \frac{dx}{dt}, \frac{dy}{dt}, \frac{dz}{dt} \right \rangle</mrow>
                  <mrow> \amp = \nabla f \cdot \vr ' (t)</mrow>
                </md>.
                Thus 
                <me>
                  0 = F'(t_0) = \nabla f (x_0, y_0, z_0) \cdot \vr ' (t_0)
                </me>.
              </p>
              <p>
                Note that along the curve <m>C</m>, <m>g(x, y, z) = c</m> and <m>h(x, y, z) = k</m>, so both functions are constant. Thus their rate of change must be <m>0</m> and so we have  
                <md>
                  <mrow> \frac{d}{dt} g( \vr (t)) \amp = 0 \text{ and} </mrow>
                  <mrow> \frac{d}{dt} h( \vr (t)) \amp = 0 </mrow>
                </md>.
                Again by Chain Rule  
                <md>
                  <mrow> \frac{dg}{dt} \amp = \frac{\partial g}{\partial x} \cdot \frac{dx}{dt} + \frac{\partial g}{\partial y} \cdot \frac{dy}{dt} + \frac{\partial g}{\partial z} \cdot \frac{dz}{dt}</mrow>
                  <mrow> \amp = \left \langle \frac{\partial g}{\partial x}, \frac{\partial g}{\partial y} , \frac{\partial g}{\partial z}\right  \rangle \cdot \left \langle \frac{dx}{dt}, \frac{dy}{dt}, \frac{dz}{dt} \right \rangle </mrow>
                  <mrow> \amp = \nabla g \cdot \vr ' (t)</mrow>
                </md>  
                and so  
                <me>
                  0 = g'(\vr(t_0)) = \nabla g (x_0, y_0, z_0) \cdot \vr ' (t_0)
                </me>.
                Similarly 
                <me>
                  0 = h'(\vr(t_0)) = \nabla h (x_0, y_0, z_0) \cdot \vr ' (t_0)
                </me>.
              </p>
              <p>
                Note that <m>\vr ' (t_0)</m> is the tangent vector to <m>f(t)</m> at <m>t = t_0</m>. Thus the above results show that <m>\nabla f(x_0, y_0, z_0), \nabla g(x_0, y_0, z_0)</m>, and <m>\nabla h(x_0, y_0, z_0)</m> are all orthogonal to the tangent vector of <m>C</m> since the dot product of each of these with the tangent vector <m>\vr ' (t_0)</m> is <m>0</m>. Thus all three of these gradient vectors are orthogonal to <m>C</m> at <m>P</m> and therefore they all lie in the same plane.
              </p>
            </li>
            <li>
              <p>
                We are considering the plane that contains the point <m>P = (x_0, y_0, z_0)</m> as well as the non-parallel vectors <m>\nabla g(x_0, y_0, z_0)</m> and <m>\nabla h(x_0, y_0, z_0)</m>. Note that we could compute the cross product of these vectors to find a normal vector of the plane, then use that to write an equation of the plane. Here we claim (informally) that any point in the plane can be obtained by starting at <m>P</m>, moving some distance in the direction of <m>\nabla g(x_0, y_0, z_0)</m> and then moving some distance in the direction of  <m>\nabla h(x_0, y_0, z_0)</m>. In other words, an arbitrary point in the plane can be expressed as <m>s \nabla g(x_0, y_0, z_0) + t \nabla h(x_0, y_0, z_0)</m>. (Using ideas from linear algebra, we claim that the plane determined by <m>\nabla g(x_0, y_0, z_0)</m> and <m>\nabla h(x_0, y_0, z_0)</m> is the span of these two vectors, and thus every point in the plane can be expressed as a linear combination of these two vectors.)
              </p>
            </li>
            <li>
              <p>
                For this exercise we have <m>f(x, y, z) = x + 2y, g(x, y, z) = y^2 + z^2</m>, and <m>h(x, y, z) = x + y + z</m>. Thus <m>\nabla f(x, y, z) = \langle 1, 2, 0 \rangle,\nabla g(x, y, z) = \langle 0, 2y, 2z \rangle </m>, and <m>\nabla h(x, y, z) = \langle 1, 1, 1 \rangle</m>. Therefore the system of equations we have to solve is 
                <md>
                  <mrow> \langle 1, 2, 0 \rangle \amp = \lambda \langle 0, 2y, 2z \rangle + \mu \langle 1, 1, 1 \rangle </mrow>
                  <mrow>y^2 + z^2 \amp = 8 </mrow>
                  <mrow>x + y + z \amp = 10 </mrow>
                </md>
                or 
                <md>
                  <mrow>1 \amp = \lambda (0) + \mu(1) </mrow>
                  <mrow>2 \amp = \lambda (2y) + \mu(1) </mrow>
                  <mrow>0 \amp = \lambda (2z) + \mu(1) </mrow>
                  <mrow>y^2 + z^2 \amp = 8 </mrow>
                  <mrow>x + y + z \amp = 10 </mrow>
                </md>.
                From the first equation we get <m>\mu = 1</m>. Plugging that into the second and third equations above yields <m>y = \frac{1}{2 \lambda}</m> and <m>z = - \frac{1}{2 \lambda} </m>, with <m>\lambda \neq 0 </m>. Substituting these values into the fourth equation above gives us  
                <me>
                  8 = \left ( \frac{1}{2 \lambda} \right )^2 + \left (- \frac{1}{2 \lambda} \right )^2
                </me>.
                Simplifying yields  
                <me>
                  16 \lambda ^2 = 1
                </me>, 
                and so we find <m>\lambda = \pm \frac{1}{4}</m>. If <m>\lambda = \frac{1}{4}</m>, we have <m>y = 2</m> and <m>z = -2</m>. Substituting these values into the fifth equation above yields <m>x = 10</m>. Following the same approach for <m>\lambda = - \frac{1}{4}</m> yields <m>y = -2, z = 2</m>, and <m>x = 10</m>.   
              </p>
              <p>
                Finally, we use these values to find the maximum and minimum of <m>f</m> subject to the constraints. Since <m>f(x, y, z) = x + 2y</m>, we have <m>f(10, 2, -2) = 10 + 2(2) = 14</m> and <m>f(10, -2, 2) = 10 + 2(-2) = 6</m>. So, subject to the given constraints, the maximum of <m>f</m> is 14 and the minimum of <m>f</m> is 6.
              </p>
            </li>
          </ol>  
        </solution>
        
      </exercise>

      <exercise xml:id="ex-10-8-multiplier">
        <statement>
          <p>
            There is a useful interpretation of the Lagrange multiplier <m>\lambda</m>. Assume that we want to optimize a function <m>f</m> with constraint <m>g(x,y)=c</m>. Recall that an optimal solution occurs at a point <m>(x_0, y_0)</m> where <m>\nabla f = \lambda \nabla g</m>. As the constraint changes, so does the point at which the optimal solution occurs. So we can think of the optimal point as a function of the parameter <m>c</m>, that is <m>x_0 = x_0(c)</m> and <m>y_0=y_0(c)</m>. The optimal value of <m>f</m> subject to the constraint can then be considered as a function of <m>c</m> defined by <m>f(x_0(c), y_0(c))</m>. The Chain Rule shows that
            <me>
              \frac{df}{dc} = \frac{\partial f}{\partial x_0} \frac{dx_0}{dc} + \frac{\partial f}{\partial y_0} \frac{dy_0}{dc}.
            </me>
            <ol marker="a.">
              <li>
                <p>
                  Use the fact that <m>\nabla f = \lambda \nabla g</m> at <m>(x_0,y_0)</m> to explain why
                  <me>
                    \frac{df}{dc} = \lambda \frac{dg}{dc}.
                  </me>
                </p>
              </li>

              <li>
                <p>
                  Use the fact that <m>g(x,y) = c</m> to show that
                  <me>
                    \frac{df}{dc} = \lambda.
                  </me>
                  Conclude that <m>\lambda</m> tells us the rate of change of the function <m>f</m> as the parameter <m>c</m> increases (or by approximately how much the optimal value of the function <m>f</m> will change if we increase the value of <m>c</m> by 1 unit).
                </p>
              </li>

              <li>
                <p>
                  Suppose that <m>\lambda = 324</m> at the point where the package described in <xref ref="PA_10_8">Preview Activity</xref> has its maximum volume. Explain in context what the value <m>324</m> tells us about the package.
                </p>
              </li>

              <li>
                <p>
                  Suppose that the maximum value of a function <m>f = f(x,y)</m> subject to a constraint <m>g(x,y) = 100</m> is <m>236</m>. When using the method of Lagrange multipliers and solving <m>\nabla f = \lambda \nabla g</m>,  we obtain a value of <m>\lambda = 15</m> at this maximum. Find an approximation to the maximum value of <m>f</m> subject to the constraint <m>g(x,y) = 98</m>.  
                </p>
              </li>

            </ol>
          </p>
        </statement>

        <answer>
          <ol marker="a.">
            <li>
              <p>
                The Chain Rule shows that
                <md>
                  <mrow>\frac{df}{dc} \amp = \frac{\partial f}{\partial x_0} \frac{dx_0}{dc} + \frac{\partial f}{\partial y_0} \frac{dy_0}{dc}</mrow>
                  <mrow>\amp = \left(\lambda \frac{\partial g}{\partial x_0} \right) \frac{dx_0}{dc} + \left(\lambda \frac{\partial g}{\partial y_0} \right) \frac{dy_0}{dc}</mrow>
                  <mrow>\amp = \lambda \left(\frac{\partial g}{\partial x_)} \frac{dx_)}{dc} + \frac{\partial g}{\partial y_0} \frac{dy_0}{dc} \right)</mrow>
                  <mrow>\amp = \lambda \frac{dg}{dc}</mrow>
                </md>.
              </p>
            </li>
            <li>
              <p>
                Since <m>g(x,y)=c</m>, we have <m>\frac{dg}{dc} = 1</m>.
                So
                <me>
                  \frac{df}{dc}  = \lambda \frac{dg}{dc} = \lambda
                </me>.
              </p>
            </li>
            <li>
              <p>
                If we could increase the girth plus the length by 1 inch,
                the maximum volume of our package will increase by approximately 324 cubic inches.
              </p>
            </li>
            <li>
              <p>
                206
              </p>
            </li>
          </ol>
        </answer>

        <solution>
          <ol marker="a.">
            <li>
              <p>
                The Chain Rule shows that
                <md>
                  <mrow>\frac{df}{dc} \amp = \frac{\partial f}{\partial x_0} \frac{dx_0}{dc} + \frac{\partial f}{\partial y_0} \frac{dy_0}{dc}</mrow>
                  <mrow>\amp = \left(\lambda \frac{\partial g}{\partial x_0} \right) \frac{dx_0}{dc} + \left(\lambda \frac{\partial g}{\partial y_0} \right) \frac{dy_0}{dc}</mrow>
                  <mrow>\amp = \lambda \left(\frac{\partial g}{\partial x_)} \frac{dx_)}{dc} + \frac{\partial g}{\partial y_0} \frac{dy_0}{dc} \right)</mrow>
                  <mrow>\amp = \lambda \frac{dg}{dc}</mrow>
                </md>.
              </p>
            </li>
            <li>
              <p>
                Since <m>g(x,y)=c</m>, we have <m>\frac{dg}{dc} = 1</m>.
                So
                <me>
                  \frac{df}{dc}  = \lambda \frac{dg}{dc} = \lambda
                </me>.
              </p>
            </li>
            <li>
              <p>
                If we could increase the girth plus the length by 1 inch,
                the maximum volume of our package will increase by approximately 324 cubic inches.
              </p>
            </li>
            <li>
              <p>
                Finding <m>\lambda = 15</m> tells us that if the constraint increases by 1 then the value of <m>f</m> will change by 15 units. In this case, if our constraint decreases by 2 (from <m>g(x, y) = 100</m> to <m>g(x, y) = 98</m>), we expect our maximum value of <m>f</m> to decrease by <m>15 \cdot 2 = 30</m> units. Thus our approximation for the maximum value of <m>f</m> subject to the constraint <m>g(x, y) = 98</m> is <m>236 - 30 = 206</m>.
              </p>
            </li>
          </ol>
        </solution>

        
      </exercise>

      
    </exercises>



</section>
