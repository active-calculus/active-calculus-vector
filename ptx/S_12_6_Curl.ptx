<section xml:id="S_12_6_Curl">
  <title>The Curl of a Vector Field</title>
  
    <objectives>
      <ul>
        <li>
          <p>
          What is meant by rotation of a vector field in a plane? 
          </p>
        </li>
        <li>
          <p>
            How can we generalize our two dimensional measurement of rotation to work in three dimensions?
          </p>
        </li>
        <li>
          <p>
            How can you measure the rotational strength of a vector field?
          </p>
        </li>
      </ul>
    </objectives>
    <introduction>
    <p>
      In <xref ref="S_12_5_Div">Section</xref> we examined two (and higher) dimensional vector field for how the strength of the vector field changed in different regions. In particular, we developed  the <xref ref="Div_defn">divergence</xref> of a vector field as a local (or density) measurement for how the strength of the vector field changes. In many physical settings it is also useful to measure the rotational strength of a vector field at a local scale. For instance, the vector field on the left of <xref ref="Curl_intro_vfs">Figure</xref> shows a vector field which flows in a counterclockwise fashion around the origin. The vector field on the right of <xref ref="Curl_intro_vfs">Figure</xref> shows a vector field which does not have a rotational aspect to its flow.
    </p>
      <figure xml:id="Curl_intro_vfs">
        <caption><p>Examples of vector fields with global rotation properties and without rotation in either the global or local sense.</p></caption>
        <sidebyside widths="45% 45%">
          <image source="images/fig_12_4_ex2_field1"/>
          <image source="images/Div_activity_-x-y"/>
        </sidebyside>
      </figure>
      <p>
        These global ideas of rotation are nice but are not always visually apparent or may only appear in some regions. For instance, the vector field on the left of <xref ref="Curl_intro_vfs2">Figure</xref> seems to have rotation around at least a couple of different points in a global sense. The vector field on the right of <xref ref="Curl_intro_vfs2">Figure</xref> has the rotation of the flows dependant on which quadrant you are examining.
      </p>
      <figure xml:id="Curl_intro_vfs2">
        <caption><p>Examples of vector fields with global rotation properties and without rotation in either the global or local sense.</p></caption>
        <sidebyside widths="45% 45%">
          <image source="images/Div_activity_xy1x"/>
          <image source="images/fig_12_vf1"/>
        </sidebyside>
      </figure>
    </introduction>
    <activity xml:id="Curl_PA">
      <introduction>
        <p>
          We would like to measure and understand rotation at the local level for a vector field. In order to investigate this concept, we will look at some two dimensional vector fields and think about whether the vector field shown will rotate a small pinwheel or spinner placed at a particular location.
        </p>
        <figure xml:id="spinner_fig">
          <caption> <p>A picture of our model spinner</p></caption>
          <image source="images/spinner_gif.gif"/>
        </figure>
      </introduction>
        <task xml:id="Curl_PA_task1">
          <p> For this part, look at the vector field in <xref ref="Curl_PA_task1_vf">Figure</xref>.</p>
          <figure xml:id="Curl_PA_task1_vf">
            <image source="images/Curl_-yx_field"/>
          </figure>
            <ol>
              <li>
                <p>Would a small spinner placed at the origin spin clockwise, counterclockwise, or not spin at all?</p>
              </li>
              <li>
                <p>Would a small spinner placed at <m>(1,1)</m> spin clockwise, counterclockwise, or not spin at all?</p>
              </li>
              <li>
                <p>Would a small spinner placed at <m>(-2,1)</m> spin clockwise, counterclockwise, or not spin at all?</p>
              </li>
               <li>
                <p>Are there any points on the <m>xy</m>-plane where the spinner would not turn counterclockwise?</p>
              </li>
            </ol>
        </task>
        <task xml:id="Curl_PA_task2">
          <p> For this part, look at the vector field in <xref ref="Curl_PA_task2_vf">Figure</xref>.</p>
          <figure xml:id="Curl_PA_task2_vf">
            <image source="images/Curl_xy_field"/>
          </figure>
            <ol>
              <li>
                <p>Would a small spinner placed at the origin spin clockwise, counterclockwise, or not spin at all?</p>
              </li>
              <li>
                <p>Would a small spinner placed at <m>(1,1)</m> spin clockwise, counterclockwise, or not spin at all?</p>
              </li>
              <li>
                <p>Would a small spinner placed at <m>(-2,1)</m> spin clockwise, counterclockwise, or not spin at all?</p>
              </li>
               <li>
                <p>Are there any points on the <m>xy</m>-plane where the spinner would turn differently than your descriptions in the previous part of this problem?</p>
              </li>
            </ol>
        </task>
        <task xml:id="Curl_PA_task3">
          <p> For this part, look at the vector field in <xref ref="Curl_PA_task3_vf">Figure</xref>.</p>
          <figure xml:id="Curl_PA_task3_vf">
            <image source="images/Curl_12_field"/>
          </figure>
            <ol>
              <li>
                <p>Would a small spinner placed at the origin spin clockwise, counterclockwise, or not spin at all?</p>
              </li>
              <li>
                <p>Would a small spinner placed at <m>(1,1)</m> spin clockwise, counterclockwise, or not spin at all?</p>
              </li>
              <li>
                <p>Would a small spinner placed at <m>(-2,1)</m> spin clockwise, counterclockwise, or not spin at all?</p>
              </li>
               <li>
                <p>Are there any points on the <m>xy</m>-plane where the spinner would turn differently than your descriptions in the previous part of this problem?</p>
              </li>
            </ol>
        </task>
        <task xml:id="Curl_PA_task4">
          <p> For this part, look at the vector field in <xref ref="Curl_PA_task4_vf">Figure</xref>. You may find it useful to recenter the plot on your point by changing <m>x_0</m> and <m>y_0</m>. You may also zoom in on your point by using the slider labeled zoom. </p>
          <!-- <figure xml:id="Curl_PA_task4_vf">
            <image source="images/Curl_1xxy_field"/>
          </figure> -->
          <figure xml:id="Curl_PA_task4_vf">
            <caption>A Sage applet for solving linear systems</caption>
                    <interactive xml:id="sage_curl_interact" platform="sage" width="110%" aspect="2:5">
                <slate surface="sage">
                    var('x,y,t')
                    @interact
                    def curl_explorer(f=input_box(default=1-x,label="First Component Equation $F_1=$"),g=input_box(default=x*y,label="Second Component Equation $F_2=$"),zoom=slider(-1,3,1,0),x0=input_box(default=1,label="$x_0$"),y0=input_box(default=1,label="$y_0$")):
                        d=2
                        zoom_level=(1/2)^zoom
                        plot1=plot_vector_field((f,g),(x,x0-(d*zoom_level),x0+(d*zoom_level)),(y,y0-(d*zoom_level),y0+(d*zoom_level)),frame=False,axes_labels=["x","y"],aspect_ratio=1)
                        plot1+=point([(x0,y0)],color='red',size=20)+text("$(x_0,y_0)$",(x0+0.1,y0+(0.1)),color='red',fontsize='large',clip=True)
                        show(plot1)
                </slate>
            </interactive>
        </figure>
        <ol>
              <li>
                <p>Would a small spinner placed at the origin spin clockwise, counterclockwise, or not spin at all?</p>
              </li>
              <li>
                <p>Would a small spinner placed at <m>(0,2)</m> spin clockwise, counterclockwise, or not spin at all?</p>
              </li>
              <li>
                <p>Would a small spinner placed at <m>(-2,1)</m> spin clockwise, counterclockwise, or not spin at all?</p>
              </li>
               <li>
                <p>Are there any points on the <m>xy</m>-plane where the spinner would turn differently than your descriptions in the previous part of this problem?</p>
              </li>
            </ol>
            <p> 
          </p>
          
        </task>
    </activity>
    <subsection xml:id="Curl_development">
    <p>
      In this section, we will measure the circulation of a vector field for a path around a point and use this idea to generalize to a circulation density. Specifically, we will measure the circulation of a vector field as we move around a square centered on some point. Using this meausurement, we will look at the density of the circulation by dividing by the area, thus allowing us to compare our measurement across different sized regions. By taking the limit as our square's side length goes to zero, we will have a measurement for how the circulation density can be measured at a point. Just as in our discussion of <xref ref="Div_development">Subsection</xref>, we will look at two dimensional setting first then examine how our argument can be generalized to higher dimensions.
    </p>
    <p>
      Let's start by measuring the circulation around a square with side length <m>2h</m> centered at a point <m>(a,b)</m>. Namely, we will look at the line integral of our vector field as we move along the square curve shown in <xref ref="Curl_dev_square">Figure</xref>.
    </p>
      <figure xml:id="Curl_dev_square">
        <caption><p>A square with side lengths <m>2h</m> traveled counterclockwise around the point <m>(a,b)</m>.</p></caption>
        <image width ="55%" source="images/Square_with_arrows"/>
      </figure>
      <p>
        We can parameterize the top edge of the box (in red) using the parameter <m> -h\geq t\geq h</m> as <m>\vr_{top}(t) = \langle a+t,b+h\rangle</m>. Similarly, the bottom, right, and left can be parameterized by  <m>\vr_{bottom}(t) = \langle a+t,b-h\rangle</m>,  <m>\vr_{right}(t) = \langle a+h,b+t\rangle</m>, and  <m>\vr_{left}(t) = \langle a-h,b+t\rangle</m>.
      </p>
      <p>
        We want to know how much of the vector field is parallel to the direction of travel, so
      
       Give the exact process for something like the top edge but then give results of the other sides. Pay attention to orientation since our square is oriented ccw. talk about how we will view ccw rotation in the xy plane as "positive" rotation and thus cw is "negative". This part will culminate in writing the four line integrals with a simplification that we only need to pay attention to one component of the vector field. Thus we get 4 single variable calculus integrals.
      </p>
    <p>
      we will convert our measurment to a density (rotation per unit area) to be able to compare the results as we change the size of the square. If we have a larger square we will probably have a larger circulation since there is more distance to accumulate how the vector field is moving in the same direction as our path. Once we set up the density arguement, we use a MVT argument to trade our integrals for a function evaluation along the segment. This will allow us to show that in the limit we will have a center difference method for calculating the partial derivatives of certain components of the vector field.
      </p>
      <p>
      Summarize the result of this in contrast to the divergence, namely that we get partial of F_1 with respect to y and partial of F_2 with respect to x because we are looking at the deflection (rate change in the direction of the vf) to measure rotation, whereas divergence looked at the change in the strength of the vf.
    </p>
    <p>
      Now we make an argument about how to do the same thing on a 3D vf. If we look at rotation at a point (a,b,c), then we can really think of this as the linear combinations of rotations as measured on the planes z=c, y=b, and x=a. Thus we can apply the same argument above to each of the appropriate planes and get the curl as we know it. We will need to take an aside with each plane and talk about how the presentation of each plane relates to whether i, j, or k is going into or out of the page. xy-plane and yz-plane are coming out of the plane where as xz-plane presentation has j going into the page (this is the reason for the alternating sign in some presentaions of the curl formula.
    </p>
    <p>
      Should also mention that there is nothing special about using a square other than it simplified the calculations involved in the circulation density. Conceptually, you will often see a circle but our use of rectangular coordinates makes it easiest to use rectangular figures.
    </p>
  </subsection>
    <definition>
      <statement>
        <p> The definition of the curl goes here. </p>
      </statement>
    </definition>
    <activity xml:id="curl_activity">
        <title>Curl in 3D</title>
        <task xml:id="curl_act_task1">
            <title></title>
            <p>
            Have students look at 3D vector field plot, mention how it is hard to "see" rotation in 3D since we are not used to visualization depth. So we will look at the planes described above.
            Have a sliced plot with z=c for the appropriate value. Ask about whether a spinner will have positive, negative, or no rotation. What direction will the axis of rotation be for this plane? State your answer as a vector.
          </p>
        </task>
        <task xml:id="curl_act_task2">
           <p> Show the other two trace slices of the vector field plots. Ask about value of circulation and axis of rotation for each plane. </p>
        </task>
        <task xml:id="curl_act_task3">
          <p>Have students summarize thier rotation predictions as a linear combination of the vectors representing the axes of rotations.</p>
        </task>
        <task xml:id="curl_act_task4">
          <p>
            Give the algebraic form of the vf. Have students compute the curl. 
          </p>
        </task>
        <task xml:id="curl_act_task5">
          <p>Compare the result of the curl to the prediction from <xref ref="curl_act_task3">Question</xref> </p>
        </task>
    </activity>
<p>
  Include a few 3D vf plots (in calcplot3d? or sage?) with a point included. Give examples where the curl is non-zero, a constant vf, and a point source vf. For the last two examples, talk about how any slice around any point will have the same rotational argument.
</p>
<p>
  Include an example where the curl has different values in different quadrants. Maybe include an interact that will allow the user to input a point, toggle whether the curl vector is displayed and have a slider to zoom in around the point. Probably need to include a slider that will change the density of vectors displayed around the point. 
  </p>

  <p>
    Exercises will include several purely calculation based questions
  </p>

  <p>
    Should we have a subsection at the end of each section that shows how to do the relevent graphs and computations in Sage or Calcplot3d?
  </p>
</section>

