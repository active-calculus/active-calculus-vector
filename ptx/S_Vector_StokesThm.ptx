<section xml:id="S_Vector_StokesThm">
  <title>Stokes' Theorem</title>
<objectives>
  <ul>
    <li>
      <p>
	What is the relationship between the circulation of a vector
	field <m>\vF</m> along a simple closed curve <m>C</m> in
	three-dimensional space and the flux integral of
	<m>\curl\vF</m> through a surface with <m>C</m> as
	its boundary?
      </p>
    </li>
    <li>
      <p>
        Why does the flux integral of <m>\curl\vF</m> through a
        surface with boundary only depend on the boundary of the
        surface and not the shape of the surface's interior?
      </p>
    </li>
  </ul>
</objectives>
<introduction>
  <p>
    When we studied <xref ref="thm_Green" text="title" /> in <xref
    ref="S_Vector_GreensTheorem" text="type-global" />, we saw how
    integrating the circulation density over a region in the plane
    bounded by a simple closed curve gave an alternative way of
    calculating the circulation along the boundary curve. When we
    consider simple closed curves in <m>\R^3</m>, the
    situation gets more complicated. However, there is an interesting,
    and perhaps surprising, generalization of <xref ref="thm_Green"
    text="title" /> for us to examine.
  </p>
  <exploration xml:id="PA_Vector_StokesThm">
    <introduction>
      <p>
       In this activity, we will look at how we can apply the ideas
       about circulation along overlapping curves from the beginning
       of <xref ref="SS_Vector_GreensTheorem_Circulation"
       text="type-global" /> to curves in space.
      </p>
    </introduction>
    <task xml:id="Stokes_PA_task1">
      <introduction>
	<p>
        For this part, consider the curves in <xref
	ref="fig_Vector_StokesThm_curves_high_line">Figure</xref>, where the yellow curve is
	<m>Y</m>, the blue curve is <m>B</m>, and the magenta curve is
	<m>M</m>. 
      </p>
      <figure xml:id="fig_Vector_StokesThm_curves_high_line">
        <caption>Three curves in space</caption>
        <interactive xml:id="int_Vector_StokesThm_curves_high_line" platform="sage" width="100%" aspect="1:1">
          <slate surface="sage">
            var('t,s,x,y,z,r,theta')
            @interact
            def _():
              plot1=parametric_plot3d((cos(t),sin(t),cos(2*t)),(t,0,pi),color="#DC267F",thickness=2)+parametric_plot3d((cos(t),sin(t),cos(2*t)),(t,pi,2*pi),color="#FFB000",thickness=2)+parametric_plot3d((t,0,1),(t,-1,1),color="#648FFF",thickness=2)+arrow3d((-.1,0,1),(.1,0,1),color="#648FFF")
              show(plot1+text3d("B",(0.1,0,1),color="#648FFF")+text3d("Y",(-0.8,-0.6,0.5),color="#FFB000")+text3d("M",(0.5,0.7,-0.5),color="#DC267F"))
	  </slate>
        </interactive>
      </figure>
      </introduction>
      <task>
	<statement>
          <p>Write out the circulation line integrals of the closed
          curve consisting of the yellow curve <m>Y</m> and the and
          blue curve <m>B</m>. (Remember to consider orientation!)
          Assume that this curve is oriented counterclockwise when
          viewed from the positive <m>z</m>-axis.
	  </p>
	</statement>
      </task>
      <task>
	<statement>
          <p>Write out the circulation line integrals of the closed
          curve consisting of the magenta curve <m>M</m> and the blue
          curve <m>B</m>. (Remember to consider orientation!) Assume
          that this curve is oriented counterclockwise when viewed
          from the positive <m>z</m>-axis.</p>
	</statement>
      </task>
      <task>
	<statement>
          <p>Write out the circulation line integrals of the closed
          curve consisting of the yellow curve <m>Y</m> and the
          magenta curve <m>M</m>. As before, assume a counterclockwise
          orientation for this curve when viewing from the positive
          <m>z</m>-axis.</p>
        </statement>
      </task>
      <task>
	<statement>
          <p>Why does it make sense that we can add the results of the
          first two parts and get the third?</p>
        </statement>
      </task>
      <task>
	<statement>
	  <p>Would your arguments from above change at all if you
	  considered the curves depicted in <xref
	  ref="fig_Vector_StokesThm_curves_low_line"
	  text="type-global" />?</p>
          <figure xml:id="fig_Vector_StokesThm_curves_low_line">
            <caption>Three slightly different curves in space</caption>
            <interactive xml:id="int_Vector_StokesThm_curves_low_line" platform="sage" width="100%" aspect="1:1">
              <slate surface="sage">
                var('t,s,x,y,z,r,theta')
                @interact
                def _():
                  plot1=parametric_plot3d((cos(t),sin(t),cos(2*t)),(t,pi/4,5*pi/4),color="#DC267F",thickness=2)+parametric_plot3d((cos(t),sin(t),cos(2*t)),(t,5*pi/4,9*pi/4),color="#FFB000",thickness=2)+parametric_plot3d((t,t,0),(t,-sqrt(2)/2,sqrt(2)/2),color="#648FFF",thickness=2)+arrow3d((-.1,-.1,0),(.1,.1,0),color="#648FFF")
                  show(plot1+text3d("B",(0.1,0,0),color="#648FFF")+text3d("M",(-0.8,-0.6,0.5),color="#DC267F")+text3d("Y",(0.5,-0.7,-0.5),color="#FFB000"))
              </slate>
            </interactive>
          </figure>
	</statement>
      </task>
    </task>
    <task xml:id="Stokes_PA_task2">
      <statement>
      <p> We will now let <m>C</m> be the simple closed curve
      consisting of the yellow and magenta curves in <xref
      ref="fig_Vector_StokesThm_curves_high_line" text="type-global"
      />. You can see <m>C</m> plotted in red in <xref
      ref="fig_Vector_StokesThm_fill_in_surfaces" text="type-global"
      />. The drop-down allows you to select three different
      surfaces. Visually verify that each of the three surfaces
      contains <m>C</m>.</p>
      <figure xml:id="fig_Vector_StokesThm_fill_in_surfaces">
        <caption>Surfaces containing a common simple closed curve</caption>
        <interactive xml:id="int_Vector_StokesThm_pringle_surfaces" platform="sage" width="100%" aspect="60:65">
        <slate surface="sage">
          var('t,s,x,y,z,r,theta')
          @interact
          def _(s=selector(['Surface1', 'Surface2','Surface3'],label="Surface Selection:")):
            plot1=parametric_plot3d((cos(t),sin(t),cos(2*t)),(t,0,2*pi),color="red",thickness=50)
            if s=='Surface1':
              surface=parametric_plot3d((r*cos(t),r*sin(t),r^2*(cos(t)^2-sin(t)^2)),(t,0,2*pi),(r,0,2),color="gray",opacity=.25)
            if s=='Surface2':
              surface=parametric_plot3d((r*cos(t),r*sin(t),(1-cos(pi*r))*(cos(t)^2-sin(t)^2)),(t,0,2*pi),(r,0,2),color="gray",opacity=.45)
            if s=='Surface3':
              surface=parametric_plot3d((r*cos(t),r*sin(t),(r^6)*(cos(t)^2-sin(t)^2)),(t,0,2*pi),(r,0,1.5), color="gray",opacity=.45,aspect_ratio=(1,1,.1))
            show(plot1+surface)
        </slate>
        </interactive>
      </figure>
      <p></p>
      </statement>
    </task>
  </exploration>
</introduction>
<subsection xml:id="Stokes_Thm_development">
  <title>Behind circulation in three dimensions</title>
  <p>
    In this subsection, we will look at the correspondence between circulation around a path in three dimensions and the circulation density "inside" the path. As you saw in <xref ref="Stokes_PA_task2">Activity part</xref>, there is not just one way to fill in the interior of a simple closed curve in three dimensions. For now, we will pick some surface <m>S_1</m> that has our simple closed curve <m>C_1</m> as its boundary, like in <xref ref="base_surface">Figure</xref>.
  </p>
  <figure xml:id="base_surface">
    <caption>Our base surface<m>S_1</m> with boundary given by our simple closed curve <m>C_1</m></caption>
    <interactive platform="sage" width="100%" aspect="1:1">
    <slate surface="sage">
      var('t,s,x,y,z,r,theta')
      @interact
      def _():
        plot1=parametric_plot3d((cos(t),sin(t),cos(2*t)),(t,0,2*pi),color="red",thickness=2)+parametric_plot3d((r*cos(t),r*sin(t),r^2*(cos(t)^2-sin(t)^2)),(t,0,2*pi),(r,0,1),color="gray",opacity=.75)
        show(plot1)
    </slate>
    </interactive>
  </figure>
  <p>
    The 3D analog of circulation density is the curl, which measures the maximal rotational strength as a vector. In order to generalize the circulation density argument we did in the Green's Theorem section, we need to know how much of circulatiton density there is at each point on the surface of <m>S_1</m>. Remember that given a parameterization of a surface we can calculate the vector form of the surface area element <m>\vS</m>, which has a direction orthogonal to the surface.

    How much rotation is along the surface is the same as knowing how much of the curl is orthogonal to the surface.

    In other words, integrating the circulation density over <m>S_1</m> is the same as look at the flux of the curl through <m>S_1</m>, given by 
    <me>
    	\int_{S_1} curl(\vF)\cdot d\vS
    </me>
    If we used a different surface <m>S_2</m> with boundary <m>C_1</m> then we will get same flux. Why? by our Green's Theorem argument, no matter how we cut up the area, the only parts of the circulations that don't get cancelled out correspond to the boundary. Since we have the same boundary, we will have the same flux. 
  </p>
</subsection>
<subsection xml:id="Stokes_Thm_statement">
  <title>Stokes' Theorem</title>
  <theorem xml:id="Stokes_Thm">
    <statement>  
      <p>
      Put the right theorem here...
      <me>
        \int_C \vF\cdot d\vr = \int_a^b \vF(\vr(t))\cdot \vr'(t)\, dt
      </me>.
      </p>
    </statement>
  </theorem>
  <p>
    If we have a problem that fits the conditions of Stokes' Theorem, the we can trade the following problems:
    <ol>
      <li>Calculate the circulation over a closed simple path in space </li>
      <li>Integrate the flux of the curl over any surface that has a boundary given by our closed, simple path in space</li>
    </ol>
  </p>
  <activity xml:id="verify_Stokes_Thm">
    <title>Checking Stokes' Theorem</title>
    <task xml:id="verify_Stokes_Thm_task1">
      <statement>
      <p>
        could use something like the diagonal great line of sphere (along the trace of x=z) as our path.
      </p>
      </statement>
    </task>
    <task xml:id="verify_Stokes_Thm_task2">
      <statement>
      <p>
        Set up and evaluate the line integral to calculate the circulation directly
      </p>
      </statement>
    </task>
    <task xml:id="verify_Stokes_Thm_task3">
      <statement>
      <p>
        Give parameterization of the hemisphere with proper boundary. Suggest using spherical coordinates to evaluate
      </p>
      </statement>
    </task>
    <task xml:id="verify_Stokes_Thm_task4">
      <statement>
      <p>
        Use the previous part to set up and evaluate the flux integral on the right side of Stokes' Theorem. Suggest using Sage to calculate?
      </p>
      </statement>
    </task>
    <task xml:id="verify_Stokes_Thm_task5">
      <statement>
        <p>
          Verify that both the line integrals of the circulation and the flux integral of the curl give same result.
        </p>
      </statement>
    </task>
    <task xml:id="verify_Stokes_Thm_task6">
      <statement>
      <p>
        Give parameterization of the plane with proper boundary. Suggest using polar coordinates to evaluate
      </p>
      </statement>
    </task>
    <task xml:id="verify_Stokes_Thm_task7">
      <statement>
        <p>
          Use the previous part to set up and evaluate the flux integral on the right side of Stokes' Theorem. Suggest using Sage to calculate?
        </p>
      </statement>
    </task>
    <task xml:id="verify_Stokes_Thm_task8">
      <statement>
        <p>
          Verify that this flux integral of the curl give same result.
        </p>
      </statement>
    </task>
  </activity>
  <p>
    mention that you should use the freedom to make your surface whatever you want should make your life easier, not harder. 
  </p>
</subsection>

</section>
